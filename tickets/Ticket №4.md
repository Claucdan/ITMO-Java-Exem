# Системы сборок, предназначение, ключевые особенности. Понятие модульности и конвенций иерархия пакетов.
## Общая информация
### Из чего состоит программа
- кодовая база;
- ресурсы, необходимые для работы приложения, (конфигурация, картинки и т.д.);
- библиотеки;
- стороннее ПО, (СУБД, сервера, брокеры сообщений);
- что угодно еще...
### Системы сборки
> инструменты для автоматизации процессов компиляции, тестирования, упаковки и развертывания Java-приложений. Они упрощают управление зависимостями, настройку проекта и сборку исполняемых файлов (JAR, WAR и др.).
### Зачем нужны
- простота подключения зависимостей
- упрощение этапов компиляции, тестирования и упаковки
- поддержка разных сред разработки
## Maven
### Что это за чудо
Инструмент/фреймворк/система, помогающая разработчикам и специалистам DevOps собрать проект со всеми необходимыми для его работы библиотеками и запустить его в среде эксплуатации

Maven основывается на *объектной модели проекта* (POM). Кроме файлов, содержащих код, и необходимых библиотеках также в эту модель входят файлы конфигурации, информация о разработчиках, дефектах, организации-разработчике, лицензиях и т.д.

>*Объектная модель в Java* — это представление данных и логики приложения в виде взаимосвязанных объектов, которые основаны на классах
### Зависимости в maven
#### Информация
##### Зависимости
Зависимость в терминологии Maven – это какая-либо библиотека, которая необходима данному проекту для корректной работы. Библиотека представляет из себя обычный Java-проект, который собрали и распространили с помощью Maven

У таких проектов есть три идентификатора:
- **groupId**
- **artifactId**
- **version**
##### Области видимости зависимостей
Каждую зависимость можно подключить к конкретному этапу сборки проекта.

Например, можно подключить зависимость так, чтобы она существовала в проекте только на фазе тестирования. То есть, данная библиотека будет находится в составе проекта только на этапе тестирования, а после того, как цикл прошел фазу тестирования будет исключена из проекта.

В Maven есть 6 областей видимости:
- **compile** - область видимости по умолчанию
- **provided** - аналогично типу compile, но во время выполнения зависимость подставляет JDK
- **runtime** - указывает, что зависимость не требуется во время компиляции, и будет подставлена именно во время выполнения
- **test** - указывает, что зависимость требуется только во время компиляции и выполнения
- **system** - устарела
- **import** - подставляет зависимости, указанные в отдельном блоке dependencyManagement в POM
#### Пример
Самый известный для вас на данный момент пример – это
  **org.junit.jupiter:junit-jupiter-api:5.9.2**
где:
- *org.junit.jupiter* - groupId
- *junit-jupiter-api* - artifactId
- *5.9.2* - version
### Жизненный цикл
#### Концепция
Maven основан на концепции жизненного цикла сборки. Пользователю нужно указать одну из фаз жизненного цикла, а Maven на основе конфигурации POM сам сделает все, что нужно пользователю.

Фазы Maven представляют из себя следующие команды:
- **clean**,
- **validate**,
- **compile**,
- **test**,
- **package**,
- **verify**,
- **install**,
- **site**,
- **deploy**

Которые объединяются в три жизненных цикла Maven:
- ***clean***, 
- ***default***,
- ***site***.
#### Жизненный цикл очистки
1. **pre-clean** – выполнить процессы, необходимые до очистки проекта
2. **clean** – удалить все файлы, предыдущей сборки
3. **post-clean** – выполнить процессы, необходимые для завершения очистки проекта
#### Жизненный цикл генерации сайта проекта
1. **pre-site** – выполнить процессы, необходимые до создания сайта проекта
2. **site** – генерировать сайт проекта
3. **post-site** – выполнить процессы, необходимые для завершения создания сайта и подготовки к развертыванию сайта
4. **site-deploy** – развернуть сайт на указанный веб-сервер
#### Жизненный цикл по умолчанию
1. **validate** – проверить доступность всей необходимой информации для сборки проекта
2. **compile** – скомпилировать исходный код
3. **test-compile** – скомпилировать исходный код тестов
4. **test** – запустить unit-тесты
5. **package** – упаковать скомпилированный исходный код в необходимый формат (war, jar и т.д.)
6. **integration-test** – развернуть пакет для запуска интеграционных тестов
7. **verify** – проверить собранный пакет на работоспособность
8. **install** – установить проект в локальный репозиторий
9. **deploy** – копировать полностью проверенный пакет в удаленный репозиторий (откуда потом может быть доставлен до web-сервера и развернут там)
#### Цели Maven
На самом деле, когда мы даем команду на выполнение какой-то фазы, выполняется не сама фаза, а конкретные цели, которые в ней заложены. То есть, исполняемыми *«методами являются именно цели»*.Сами фазы – это обертка, для выполнения команд используются цели.

> Например, есть фаза Maven site, мы можем ее вызвать командой mvn site, но на самом деле выполняется цель этой фазы, которая выглядит так mvn site:site

### Плагины Maven
#### Информация
Плагины Maven – это вторая после зависимостей сущность данного инструмента. Если зависимость выступает статической библиотекой, которая просто присутствует или отсутствует в проекте, то плагин – это, грубо говоря, метод, который совершает какие-то действия.

На самом деле, фазы – это и есть плагины, просто вшитые в Maven по умолчанию. Также есть еще множество различных плагинов для различных целей. А еще вы можете написать собственный плагин, нужный именно вам.

А, если быть совсем точными, то плагины – это группа целей, так как мы уже знаем, что именно за выполнение команд отвечают цели.
#### Пример
Рассмотрим подробно один из плагинов:
   **org.apache.maven.plugins:maven-jar-plugin:2.6**
тут:
 - **org.apache.maven.plugins** - groupId
 - **maven-jar-plugin** - artifactId
 - **2.6** - version

Данный плагин отвечает за генерацию документации в формате JavaDoc из исходного кода вашего проекта
### POM
POM – это одновременно и объектная модель объекта, и файл pom.xml, в котором хранится метаинформация о проекте, информация о зависимостях и описаны необходимые плагины.
## Gradle
### Что за чудо
Инструмент автоматизации сборки с открытым исходным кодом.
- помогает автоматизировать широкий спектр сценариев сборки ПО, используя встроенные функции, сторонние плагины или пользовательскую логику сборки
- предоставляет высокоуровневый, декларативный и выразительный язык сборки, который упрощает чтение и написание логики сборки
- обеспечивает надежные результаты, используя такие оптимизации, как инкрементальные сборки, кэширование сборок и параллельное выполнение
- поддерживает Android, Java, Kotlin Multiplatform, Groovy, Scala, JavaScript и C/C++
### Области видимости
#### Описание областей видимости
- **implementation** – зависимости, необходимые, как для компиляции, так и для выполнения
- **api** – открытый “implementation”
- **compileOnly** – зависимости, необходимые только для компиляции
- **compileOnlyApi** – открытый “compileOnly”
- **runtimeOnly** – зависимости, необходимые только для выполнения
- **testImplementation** – зависимости, необходимые для компиляции и выполнения тестов
- **testCompileOnly** – зависимости, необходимые только для компиляции тестов
- **testRuntimeOnly** – зависимости, необходимые только для выполнения тестов
#### Визуализация областей видимости

| Конфигурация       | Компиляция | Рантайм  | Тесты | Транзитивность |
| ------------------ | ---------- | -------- | ----- | -------------- |
| implementation     | ✓          | ✓        | ✗     | ✗              |
| api                | ✓          | ✓        | ✗     | ✓              |
| compileOnly        | ✓          | ✗        | ✗     | ✗              |
| runtimeOnly        | ✗          | ✓        | ✗     | ✓              |
| testImplementation | ✗          | ✗        | ✓     | ✗              |
| testCompileOnly    | ✗ (test)   | ✗        | ✓     | ✗              |
| testRuntimeOnly    | ✗          | ✗ (test) | ✓     | ✓              |
### Репозитории
Gradle не имеет собственных репозиториев и в качестве источника зависимостей использует Maven и Ivy репозитории. При этом интерфейс для работы с репозиториями не отличается на базовом уровне.
### Wrapper
#### Что это?
Это скрипт, который запускает задачи Gradle с объявленной версией . Если объявленная версия не установлена, Wrapper устанавливает требуемую.
#### Преимущества:
- создание проектов с помощью Wrapper локально позволяет вам предварительно не устанавливать Gradle
- у каждого участника команды и на конвейерах CI проект собирается под одной и той же версией Gradle
- легкое обновление до новой версии Gradle путем изменения настроек Wrapper
## Сравнение Maven и Gradle

#### Maven
- −проще в освоении
- набор поведений и настроек по умолчанию
#### Gradle
- производительность (инкрементальные сборки, кэш)
- гибкость
- более глубокое управление зависимостями
- поддержка нескольких языков программирования
- доменно-специфический язык программирования: DSL